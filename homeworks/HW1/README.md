# 作业1报告

2020/10/17 余畅 电子科技大学

### 问题

**Input**：已知平面内 n 个点 $P_j(x_j,y_j), j=1,2,\dots,n$。

**Output**: 拟合这些点的函数。

### 实现

本次作业由于没有时间配置所提供的框架，故使用纯C++进行完成，通过文件`data.txt`输入点集并通过`result.csv`输出插值后的点集，并使用 Excel 进行绘制。

代码中实现了`Interpolation` 的基类，提供所需的基本方法和属性，`LinearInterpolation`是线性插值函数用于显示输入点和其他插值函数进行比较，`LagrangeInterpolation`是拉格朗日方法的多项式插值类，`GaussInterpolation`是 Gauss 基函数的插值类，`LeastSquareInterpolation`是最小二乘法实现的多项式插值，`RidgeRegressionInterpolation`是在多项式插值的基础上实现了岭回归的正则项。不同的类通过实现 `evaluate()` 方法来进行不同的插值。

#### 拉格朗日插值

假设任意两个不同的 $x_i$ 都互不相同，那么应用拉格朗日插值公式所得到的多项式：

$L(x) := \sum_{j=0}^{k} y_j \ell_j(x)$

其中每个$\ell_j(x)$为拉格朗日基本多项式，其表达式为：

$\ell_j(x) := \prod_{i=0,\, i\neq j}^{k} \frac{x-x_i}{x_j-x_i} = \frac{(x-x_0)}{(x_j-x_0)} \cdots \frac{(x-x_{j-1})}{(x_j-x_{j-1})} \frac{(x-x_{j+1})}{(x_j-x_{j+1})} \cdots \frac{(x-x_{k})}{(x_j-x_{k})} $

实验结果表明，对于少量的数据点，由于使用的是低次的多项式，直接插值可以得到正确的结果，并且允许数据存在一定的误差：

![lagrange2](\image\lagrange1.png)![lagrange1](\image\lagrange2.png)

但是对于大量的数据点，使用高次多项式的结果是在插值区间的边缘出现振荡，点集的左侧和右侧也会随着最高次数的多项式快速发散，并且数据的轻微扰动也会显著影响插值的结果：

![lagrange3](\image\lagrange3.png)

查询资料后发现这种现象被称为龙格现象，表明使用高次多项式插值并不总能提高准确性。

#### 高斯基函数插值

使用 Gauss 基函数的线性组合 $f(x)=b_0 + \sum_{i=1}^{n}b_i g_i(x)$ 插值 ${P_j}$，其中 $$ g_i(x)=\exp\left(-\frac{(x-x_i)^2}{2\sigma^2}\right) $$ 即对称轴在插值点上，$i=1,\dots,n$，缺省设 $\sigma =1$

代入函数值构造矩阵解线性方程组即可。

实验过程中将 $b_0$ 设为超参数，在保证 $y_i > 0$ 的条件下默认 $b_i = 0$，不同参数的实验结果如下：

![gauss](\image\gauss.png)

#### 最小二乘法 & 岭回归

固定幂基函数的最高次数 m (m<n)，使用最小二乘法：$\min E$，其中 $E(x)=\sum_{i=0}^{n}(y_i-f(x_i))^2$ 拟合 ${P_j}$。

同多项式插值类似构造$A$，$B$矩阵，所求矩阵为 $W$：

$AW=B$

$A^{T}AW=A^{T}B$

$(A^{T}A)^{-1}A^{T}AW=(A^TA)^{-1}A^{T}B$

则 $W=(A^{T}A)^{-1}A^TB$，即为所求的系数矩阵。

岭回归（Ridge Regression）：对上述最小二乘法误差函数增加 $E_1$ 正则项，参数 $\lambda$，$\min (E+\lambda E_1)$，其中 $E_1=\sum_{i=1}^n\alpha_i^2$

即 $W=(A^{T}A+\lambda I)^{-1}A^TB$

### 结果比较

在给出较小的点集时，四种插值结果都显示出较好的拟合结果，在给定次数的情况下，最小二乘法给出了最好的低次多项式近似拟合，高斯基函数插值最拟合了原离散点的分布，而拉格朗日插值在区间内插值结果较好，区间外则出现了龙格现象，实验结果如下：

![final1](\image\final1.png)

而对于较大的随机点集，拉格朗日插值直接失效，高斯基函数插值波动误差较大（给出的点集分布不均匀产生的），最小二乘法给出了较好的拟合结果，实验结果如下：

![final2](\image\final2.png)

构造生成二次函数的点集数据，并施加一个小的随机扰动，高斯基函数插值和最小二乘法都拟合的较好，实验结果如下：



![final3](\image\final3.png)

当施加一个大的扰动时，高斯基函数插值出现了过拟合，但是最小二乘法仍保持未扰动之前的分布，实验结果如下：![final4](\image\final4.png)